using System;
using System.Collections.Generic;
using System.Text;
using System.Threading.Tasks;

namespace CarService
{

//У вас есть автосервис, в который приезжают люди, чтобы починить свои автомобили.
//У вашего автосервиса есть баланс денег и склад деталей.
//Когда приезжает автомобиль, у него сразу ясна его поломка, и эта поломка отображается у вас в консоли вместе с ценой за починку(цена за починку складывается из цены детали + цена за работу).
//Поломка всегда чинится заменой детали, но количество деталей ограничено тем, что находится на вашем складе деталей.
//Если у вас нет нужной детали на складе, то вы можете отказать клиенту, и в этом случае вам придется выплатить штраф.
//Если вы замените не ту деталь, то вам придется возместить ущерб клиенту.
//За каждую удачную починку вы получаете выплату за ремонт, которая указана в чек-листе починки.

    
    class Program
    {
        static void Main(string[] args)
        {
            AutoService autoService = new AutoService();
            autoService.CreateCar(15);
            autoService.Work();
        }
    }

    class AutoService
    {
        private Dictionary<Detail, int> _wareHouse = new Dictionary<Detail, int>();
        public void CreateWarehouse()
        {
            _wareHouse.Add(new Detail("руль", 200), 5);
            _wareHouse.Add(new Detail("коробка передач", 300), 5);
            _wareHouse.Add(new Detail("радио", 250), 5);
            _wareHouse.Add(new Detail("двигатель", 800), 5);
            _wareHouse.Add(new Detail("ходовая", 500), 5);
            _wareHouse.Add(new Detail("краска", 100), 5);
            _wareHouse.Add(new Detail("печка", 400), 5);
            _wareHouse.Add(new Detail("кондицианер", 450), 5);
        }

        private Queue<Car> _brokenCars = new Queue<Car>();
        public void CreateCar(int amountOfBrokenCars)
        {
            for (int i = 0; i < amountOfBrokenCars; i++)
            {
                Car car = new Car();
                car.BreakDown();
                _brokenCars.Enqueue(car);
            }
        }

        public void Work()
        {
            CreateWarehouse();
            while (_brokenCars.Count>0)
            {
                Car car = _brokenCars.Dequeue();
                car.ShowBrokenDetails();
                ReplacePart(car);
                Console.WriteLine("Нажмите любую кнопку чтобы перейти к следующему покупателю");
                Console.ReadKey();
            }
        }

        public void ReplacePart(Car car)
        {
            for (int i = 0; i < car._brokenParts.Count; i++)
            {
                if (_wareHouse.ContainsKey(car._brokenParts[i]))
                {
                    Console.WriteLine("Машина как новая");
                }
            }
        }
    }

    class Car
    {
        private Random _random = new Random();
        private List<Detail> _spareParts = new List<Detail> 
        { 
            new Detail("руль", 200), 
            new Detail("коробка передач", 300), 
            new Detail("радио", 250), 
            new Detail("двигатель", 800),
            new Detail("ходовая", 500),
            new Detail("краска", 100),
            new Detail("печка", 400),
            new Detail("кондицианер", 450),
        };
        public List<Detail> _brokenParts = new List<Detail>();

        public void BreakDown()
        {
            int amountOfBrokenDetails = _random.Next(1, _spareParts.Count);
            for (int i = 0; i < amountOfBrokenDetails; i++)
            {
                _brokenParts.Add(_spareParts[_random.Next(0, _spareParts.Count)]);
            }
            for (int i = 0; i < _brokenParts.Count; i++)
            {
                for (int t = 1; t < _brokenParts.Count; t++)
                {
                    if (_brokenParts[i]==_brokenParts[t] && t>i)
                    {
                        _brokenParts.RemoveAt(t);
                    }
                }
            }
        }

        public void ShowBrokenDetails()
        {
            Console.WriteLine("Мне нужно починить: ");
            foreach (var brokenPart in _brokenParts)
            {
                Console.WriteLine(brokenPart.Name + " " + brokenPart.RepairCost);
            }
        }
    }

    class Detail
    {
        public string Name { get; private set; } 
        public int RepairCost { get; private set; }

        public Detail(string name, int repairCost)
        {
            Name = name;
            RepairCost = repairCost;
        }

        public void ShowInfo()
        {
            Console.WriteLine(Name + " - " + RepairCost + " денег");
        }
    }
}
